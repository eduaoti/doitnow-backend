"use strict";
// Copyright (c) Microsoft Corporation.
// Licensed under the MIT License.
Object.defineProperty(exports, "__esModule", { value: true });
exports.StatsbeatFeatureType = exports.RetryCode = exports.DropCode = exports.TelemetryType = exports.EU_ENDPOINTS = exports.EU_CONNECTION_STRING = exports.NON_EU_CONNECTION_STRING = exports.AIMS_FORMAT = exports.AIMS_API_VERSION = exports.AIMS_URI = exports.CustomStatsbeatCounter = exports.StatsbeatCounter = exports.AttachTypeName = exports.StatsbeatResourceProvider = exports.MAX_STATSBEAT_FAILURES = exports.AZURE_MONITOR_AUTO_ATTACH = exports.STATSBEAT_LANGUAGE = exports.CustomerStatsbeat = exports.NetworkStatsbeat = void 0;
exports.isStatsbeatShutdownStatus = isStatsbeatShutdownStatus;
/**
 * Statsbeat class for network telemetry.
 * @internal
 */
class NetworkStatsbeat {
    time;
    lastTime;
    endpoint;
    host;
    totalRequestCount;
    lastRequestCount;
    totalSuccessfulRequestCount;
    totalReadFailureCount;
    totalWriteFailureCount;
    totalFailedRequestCount;
    retryCount;
    exceptionCount;
    throttleCount;
    intervalRequestExecutionTime;
    lastIntervalRequestExecutionTime;
    averageRequestExecutionTime;
    constructor(endpoint, host) {
        this.endpoint = endpoint;
        this.host = host;
        this.totalRequestCount = 0;
        this.totalSuccessfulRequestCount = 0;
        this.totalReadFailureCount = 0;
        this.totalWriteFailureCount = 0;
        this.totalFailedRequestCount = [];
        this.retryCount = [];
        this.exceptionCount = [];
        this.throttleCount = [];
        this.intervalRequestExecutionTime = 0;
        this.lastIntervalRequestExecutionTime = 0;
        this.lastTime = +new Date();
        this.lastRequestCount = 0;
        this.averageRequestExecutionTime = 0;
    }
}
exports.NetworkStatsbeat = NetworkStatsbeat;
/**
 * Statsbeat class for customer-visible telemetry.
 * @internal
 */
class CustomerStatsbeat {
    totalItemSuccessCount;
    // Nested Map structure: telemetry_type -> drop.code -> drop.reason -> count
    totalItemDropCount;
    // Nested Map structure: telemetry_type -> retry.code -> retry.reason -> count
    totalItemRetryCount;
    constructor() {
        this.totalItemSuccessCount = new Map();
        this.totalItemDropCount = new Map();
        this.totalItemRetryCount = new Map();
    }
}
exports.CustomerStatsbeat = CustomerStatsbeat;
exports.STATSBEAT_LANGUAGE = "node";
exports.AZURE_MONITOR_AUTO_ATTACH = "AZURE_MONITOR_AUTO_ATTACH";
exports.MAX_STATSBEAT_FAILURES = 3;
exports.StatsbeatResourceProvider = {
    appsvc: "appsvc",
    aks: "aks",
    functions: "functions",
    vm: "vm",
    unknown: "unknown",
};
var AttachTypeName;
(function (AttachTypeName) {
    AttachTypeName["INTEGRATED_AUTO"] = "IntegratedAuto";
    AttachTypeName["MANUAL"] = "Manual";
})(AttachTypeName || (exports.AttachTypeName = AttachTypeName = {}));
var StatsbeatCounter;
(function (StatsbeatCounter) {
    StatsbeatCounter["SUCCESS_COUNT"] = "Request_Success_Count";
    StatsbeatCounter["FAILURE_COUNT"] = "Request_Failure_Count";
    StatsbeatCounter["RETRY_COUNT"] = "Retry_Count";
    StatsbeatCounter["THROTTLE_COUNT"] = "Throttle_Count";
    StatsbeatCounter["EXCEPTION_COUNT"] = "Exception_Count";
    StatsbeatCounter["AVERAGE_DURATION"] = "Request_Duration";
    StatsbeatCounter["READ_FAILURE_COUNT"] = "Read_Failure_Count";
    StatsbeatCounter["WRITE_FAILURE_COUNT"] = "Write_Failure_Count";
    StatsbeatCounter["ATTACH"] = "Attach";
    StatsbeatCounter["FEATURE"] = "Feature";
})(StatsbeatCounter || (exports.StatsbeatCounter = StatsbeatCounter = {}));
var CustomStatsbeatCounter;
(function (CustomStatsbeatCounter) {
    CustomStatsbeatCounter["ITEM_SUCCESS_COUNT"] = "preview.item.success.count";
    CustomStatsbeatCounter["ITEM_DROP_COUNT"] = "preview.item.dropped.count";
    CustomStatsbeatCounter["ITEM_RETRY_COUNT"] = "preview.item.retry.count";
})(CustomStatsbeatCounter || (exports.CustomStatsbeatCounter = CustomStatsbeatCounter = {}));
exports.AIMS_URI = "http://169.254.169.254/metadata/instance/compute";
exports.AIMS_API_VERSION = "api-version=2017-12-01";
exports.AIMS_FORMAT = "format=json";
exports.NON_EU_CONNECTION_STRING = "InstrumentationKey=c4a29126-a7cb-47e5-b348-11414998b11e;IngestionEndpoint=https://westus-0.in.applicationinsights.azure.com";
exports.EU_CONNECTION_STRING = "InstrumentationKey=7dc56bab-3c0c-4e9f-9ebb-d1acadee8d0f;IngestionEndpoint=https://westeurope-5.in.applicationinsights.azure.com";
exports.EU_ENDPOINTS = [
    "westeurope",
    "northeurope",
    "francecentral",
    "francesouth",
    "germanywestcentral",
    "norwayeast",
    "norwaywest",
    "swedencentral",
    "switzerlandnorth",
    "switzerlandwest",
    "uksouth",
    "ukwest",
];
var TelemetryType;
(function (TelemetryType) {
    TelemetryType["AVAILABILITY"] = "AVAILABILITY";
    TelemetryType["CUSTOM_EVENT"] = "CUSTOM_EVENT";
    TelemetryType["CUSTOM_METRIC"] = "CUSTOM_METRIC";
    TelemetryType["DEPENDENCY"] = "DEPENDENCY";
    TelemetryType["EXCEPTION"] = "EXCEPTION";
    TelemetryType["PAGE_VIEW"] = "PAGE_VIEW";
    TelemetryType["PERFORMANCE_COUNTER"] = "PERFORMANCE_COUNTER";
    TelemetryType["REQUEST"] = "REQUEST";
    TelemetryType["TRACE"] = "TRACE";
    TelemetryType["UNKNOWN"] = "UNKNOWN";
})(TelemetryType || (exports.TelemetryType = TelemetryType = {}));
var DropCode;
(function (DropCode) {
    DropCode["CLIENT_EXCEPTION"] = "CLIENT_EXCEPTION";
    DropCode["CLIENT_EXPIRED_DATA"] = "CLIENT_EXPIRED_DATA";
    DropCode["CLIENT_READONLY"] = "CLIENT_READONLY";
    DropCode["CLIENT_STALE_DATA"] = "CLIENT_STALE_DATA";
    DropCode["CLIENT_PERSISTENCE_CAPACITY"] = "CLIENT_PERSISTENCE_CAPACITY";
    DropCode["NON_RETRYABLE_STATUS_CODE"] = "NON_RETRYABLE_STATUS_CODE";
    DropCode["CLIENT_STORAGE_DISABLED"] = "CLIENT_STORAGE_DISABLED";
    DropCode["UNKNOWN"] = "UNKNOWN";
})(DropCode || (exports.DropCode = DropCode = {}));
var RetryCode;
(function (RetryCode) {
    RetryCode["CLIENT_EXCEPTION"] = "CLIENT_EXCEPTION";
    RetryCode["CLIENT_TIMEOUT"] = "CLIENT_TIMEOUT";
    RetryCode["RETRYABLE_STATUS_CODE"] = "RETRYABLE_STATUS_CODE";
    RetryCode["UNKNOWN"] = "UNKNOWN";
})(RetryCode || (exports.RetryCode = RetryCode = {}));
var StatsbeatFeatureType;
(function (StatsbeatFeatureType) {
    StatsbeatFeatureType[StatsbeatFeatureType["FEATURE"] = 0] = "FEATURE";
    StatsbeatFeatureType[StatsbeatFeatureType["INSTRUMENTATION"] = 1] = "INSTRUMENTATION";
})(StatsbeatFeatureType || (exports.StatsbeatFeatureType = StatsbeatFeatureType = {}));
/**
 * Status codes indicating that we should shutdown statsbeat
 * @internal
 */
function isStatsbeatShutdownStatus(statusCode) {
    return (statusCode === 401 || // Unauthorized
        statusCode === 403 || // Forbidden
        statusCode === 503 // Server Unavailable
    );
}
//# sourceMappingURL=types.js.map